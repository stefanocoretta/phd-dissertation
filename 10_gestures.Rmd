
\chapter{Gesture onset timing of voiceless and voiced stops in Italian and Polish}

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
knitr::opts_knit$set(root.dir = here::here())

library(tidyverse)
theme_set(theme_minimal())
scale_fill_discrete <- function(...) scale_fill_brewer(..., type = "qual")
scale_colour_discrete <- function(...) scale_colour_brewer(..., type = "qual")
library(brms)
library(tidybayes)

library(coretta2018itapol)
data("token_measures")

gestures <- token_measures %>%
  filter(c1_phonation == "voiceless", !is.na(c1_rel), !is.na(GONS), !is.na(max), GONS > 0, max > 0) %>%
  mutate(
    speech_rate_c = speech_rate - mean(speech_rate),
    c2_phonation = factor(c2_phonation, levels = c("voiceless", "voiced")),
    c2_place = factor(c2_place, levels = c("coronal", "velar")),
    vowel = factor(vowel, levels = c("a", "o", "u")),
    gons_max = (max - GONS) * 1000,
    rel_gons = (GONS - c1_rel) * 1000,
    closing = (NONS - GONS) * 1000,
    mid = (NOFF - NONS) + NONS,
    rel_mid = (mid - c1_rel) * 1000,
    rel_noff = (NOFF - c1_rel) * 1000
  ) %>%
  mutate_if(is_character, as_factor)

gest_gmax <- filter(gestures, gons_max > 10)
```

A consequence of the gestural organisation proposed to account for the stability of the release-to-release interval duration is that the timing of the gestural onset should not be affected by the voicing status of the consonant in disyllabic words.
In other words, the interval between the release of the the consonant preceding the vowel and the onset of the closing gesture of the post-vocalic consonant should be the same whether the consonant is voiceless or voiced.
The difference in vowel duration (and closure duration) would be a consequence of the different velocity of the closing gesture in voiceless vs voiced stops, rather than of a difference in gestural onset.

The ultrasound tongue imaging data from Study I partially suggests that the temporal distance between C1 release and C2 gestural onset is not affected by C2 voicing.
A Bayesian regression was fit to the duration of the C1 release to C2 gesture onset (GONS) interval, with C2 voicing, vowel, C2 place of articulation, interactions between voicing and vowel and voicing and place, and centred speech rate.
By speaker and by-word random intercepts were also included.
A normal distribution with mean 0 ms and SD 200 was used as prior for the intercept, while a distribution with mean 0 and SD 10 was used for vowel, place and the interactions.
For speech rate, the prior was a normal distribution with mean 0 and SD 50.

```{r rel-gons-bm}
priors <- c(
  set_prior("normal(0, 200)", class = "Intercept"),
  set_prior("normal(0, 10)", class = "b", coef = "c2_phonationvoiced"),
  set_prior("normal(0, 10)", class = "b", coef = "vowelo"),
  set_prior("normal(0, 10)", class = "b", coef = "vowelu"),
  set_prior("normal(0, 10)", class = "b", coef = "c2_placevelar"),
  set_prior("normal(0, 10)", class = "b", coef = "c2_phonationvoiced:vowelo"),
  set_prior("normal(0, 10)", class = "b", coef = "c2_phonationvoiced:vowelu"),
  set_prior("normal(0, 10)", class = "b", coef = "c2_phonationvoiced:c2_placevelar"),
  set_prior("normal(0, 50)", class = "b", coef = "speech_rate_c"),
  set_prior("cauchy(0, 25)", class = "sd"),
  set_prior("cauchy(0, 25)", class = "sigma")
)

rel_gons_bm <- brm(
  rel_gons ~
    c2_phonation +
    c2_place +
    vowel +
    c2_phonation:c2_place +
    c2_phonation:vowel +
    speech_rate_c +
    (1|speaker) +
    (1|item),
  prior = priors,
  data = gestures,
  cores = 4,
  file = "./cache/rel_gons_bm"
)
```

```{r rel-gons-summary}
summary(rel_gons_bm)
```

```{r rel-gons-intervals}
rel_gons_draws <- rel_gons_bm %>%
  gather_draws(b_c2_phonationvoiced, b_c2_placevelar, b_vowelo, b_vowelu)

rel_gons_draws %>%
  ungroup() %>%
  mutate(.variable = factor(
    .variable,
    levels = c("b_vowelu", "b_vowelo", "b_c2_placevelar", "b_c2_phonationvoiced")
  )) %>%
  ggplot(aes(.value, .variable)) +
  # annotate("rect", xmin = -10, xmax = 10, ymin = -Inf, ymax = Inf, alpha = 0.5) +
  geom_vline(xintercept = 0) +
  stat_intervalh() +
  stat_pointintervalh(position = position_nudge(y = -0.2), .width = c(0.66, 0.98)) +
  scale_x_continuous(breaks = seq(-50, 25, 5)) +
  scale_y_discrete(labels = c("Vowel = /u/", "Vowel = /o/", "Place = velar", "Voicing = voiced")) +
  scale_color_brewer() +
  labs(
    x = "Difference in release to GONS (ms)",
    y = element_blank()
  ) +
  theme(panel.grid.minor = element_blank())
```

